<!-- index.html (excerpt) -->
<body>
  <!-- Intro screen with logo, then story, then game -->
  <div id="intro">
    <!-- Phase 1: Logo + Start button -->
    <img id="logo" src="images/logo.png" alt="Joby Pizza Delivery Services logo">
    <button id="start-btn" class="pulse">Start Game</button>

    <!-- Phase 2: Boss portrait + story (hidden at first) -->
    <div id="intro-content" style="display:none; flex-direction:row; align-items:center;">
      <img id="boss-img" src="images/boss.png" alt="Boss portrait" style="width:200px; image-rendering:pixelated; margin-right:20px;">
      <div id="story-text" style="font-family:'Hack',monospace; font-size:18px; border-left:2px solid #fff; padding-left:20px;"></div>
    </div>

    <!-- Audio -->
    <audio id="intro-audio" src="audio/intro.mp3" loop preload="auto"></audio>
    <audio id="game-audio"  src="audio/game.mp3"  loop preload="auto"></audio>
  </div>

  <!-- (rest of your page: map, HUD, compass, etc.) -->

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const startBtn     = document.getElementById('start-btn');
    const logo         = document.getElementById('logo');
    const introContent = document.getElementById('intro-content');
    const storyEl      = document.getElementById('story-text');
    const introAudio   = document.getElementById('intro-audio');
    const gameAudio    = document.getElementById('game-audio');

    const story = `Mark, this is JoeBen. Sorry buddy I know it's your birthday and you have a party to get to, but ya' know....we really gotta finish quota before you go home. Make 5 more deliveries and you'll be good to go. Thanks bunches.....by the way, quick reminder if you forgot how to fly. Push the screen the direction you want to go. Pick up pizzas at the Pizzeria before you fly off. You can only hold up to 5 pizzas at a time so come back when you need more. Orders come in via the phone, you can follow the compass to get you in the right direction. Thanks again for the "world's best boss" mug.`;

    let phase     = 0;   // 0 = show logo, 1 = story, 2 = start game
    let charIndex = 0;
    let typing    = false;

    function typeNextChar() {
      if (charIndex < story.length) {
        storyEl.textContent += story[charIndex++];
        setTimeout(typeNextChar, 40);
      }
    }

    function tryPlayIntro() {
      introAudio.play().catch(()=>{});
    }

    // warm up autoplay
    tryPlayIntro();

    startBtn.addEventListener('click', () => {
      if (phase === 0) {
        // switch to story
        phase = 1;
        logo.style.display         = 'none';
        introContent.style.display = 'flex';
        startBtn.textContent       = 'Play Game';
        tryPlayIntro();
        if (!typing) {
          typing = true;
          typeNextChar();
        }
        return;
      }

      if (phase === 1) {
        // go to actual game
        phase = 2;
        introAudio.pause();
        introAudio.currentTime = 0;
        gameAudio.play().catch(()=>{});
        document.getElementById('intro').style.display = 'none';
        document.getElementById('map').style.display   = 'block';
        document.getElementById('hud').style.display   = 'block';
        document.getElementById('compass').style.display = 'block';
        const script = document.createElement('script');
        script.src = 'game.js';
        document.body.appendChild(script);
      }
    });
  });
  </script>
</body>
</html>
