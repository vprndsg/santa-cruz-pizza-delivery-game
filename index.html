<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Santa Cruz Pizza Delivery Game</title>
  <!-- Leaflet CSS (OpenStreetMap) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- Game CSS -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="intro">
    <canvas id="screen"></canvas>
    <button id="start-btn">Start Game</button>
  </div>

  <!-- Map container -->
  <div id="map" style="display:none;"></div>

  <!-- Heads-up display for score and time -->
  <div id="hud" style="display:none;">Deliveries: 0/10 | Time: 60</div>

  <!-- Final game-over screen (hidden by default) -->
  <div id="game-over">
    <div id="game-over-content"></div>
  </div>

  <!-- Leaflet JS library -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
(() => {
/*--- settings ---*/
const glyphs      = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*(){}[]=+";
const revealDelay = 2000;   /* milliseconds before the portrait begins */
const revealSteps = 30;     /* frames needed to lock each symbol */
const rainSpeed   = 30;     /* shorter delay between rain frames = faster fall */

/* ASCII portrait (120 × 40) + speech box */
const faceArt = [
"                                         ..  .  .. .   ..        .               .                                      ",
"                                     .................................................                                  ",
"                                     ...........:.:..::......:::......:...::....:.....                                  ",
"                                     .........::::::::::::::::::::::::::....:::::.....                                  ",
"                                  .  . ....:..:::::::::::::::::::::::::::::::::::.:...                                  ",
"                                  .........:::::::::::::::::::::::::::::::::::-:::....                                  ",
"                                 ....:::::..:::::::::::::::::::::::::::::::---::::....                                  ",
"                                ..::::-----:.:::-:-:::::::::::::::::::::-:::::::::::::..                                ",
"                                .....::-----::.:::-:--:.:--:-::::::------::.:---:--::::.                                ",
"                                       .::-----::.:----::------::----:::::-----::... ..                                 ",
"                                          ..::-:::::::::.-----::-::--:::--:-::.        .                                ",
"                                              ....::..:..:::::.::.:::--::.                                               ",
"                                                  ..:::. .:.... ..:...                 ..                                ",
"                                                                                      ...                                ",
"                              .....        ..             .              .....     ...:::                                ",
"                               .::::.   ..               :::--.               .....:--:..  .                            ",
"                               ..:--::.......        .   :-:-:.  .        ....:::::---:.  .                             ",
"                                ..::--:::...  .:  ..... .::---. ..::::.  ....:::----::.                                  ",
"                                 .....::.....:....::...::::-::  ..::::::......::::::..                                   ",
"                                   .. ......::.:::.. ...::::-:.:....::::::::. ..:...                                     ",
"                                       .....:::::. .:. .:::-:::: ..  .:::::::....                                        ",
"                                        ...::::.. .:-:..:::-::::.:::  ..:::::::.      .                                  ",
"                                        ...:::.    .:::.:::---:.:-::.   .:::::..                                         ",
"                                        ...::.  ..     .:::-:::::.   :.  .::::.                                          ",
"                                         :::. .:::.      ..:::.     .:::.  .::.                                          ",
"                                        .... .:::::.              .:::::::  ....                                         ",
"                                        ..  ::::......          ...::::::::. .:.                                         ",
"                                        .. .:..........        ........ ...:. ..                                         ",
"                                        .....                      ...    ......                                         ",
"                                         ..                     .. ..       ...                                          ",
"                                               ................:...::..... ..                                            ",
"                                            ..                      .....  .                                             ",
"                                                                                                                         ",
"                                                    ...:::::::......  .. .                                               ",
"                                                  ......::::::.::::..:...                                                ",
"                                                  .....................                                                  ",
"                                                     .    . .. .  ...                                                    ",
"                                                                ..                                                       ",
"                                                                                                                         ",
"                                                                                                                         ",
"+----------------------------------------------------------------------------------------------------------------------+",
"|                             hahahahah…no birthday party until you deliver those pizzas!                              |",
"+----------------------------------------------------------------------------------------------------------------------+"
];

/*--- setup ---*/
const cv   = document.getElementById('screen');
const ctx  = cv.getContext('2d');
resize();
addEventListener('resize', resize);

const cols  = Math.floor(cv.width  / 10);
const rows  = Math.floor(cv.height / 16);
const drops = Array(cols).fill(0);                       // y position of each falling column
const buf   = Array.from({length: rows}, () => Array(cols).fill(' '));
const t0    = performance.now();

/*--- loop ---*/
function loop(){
  const now = performance.now();
  const elapsed = now - t0;

  rainFrame();
  if(elapsed > revealDelay){
    const p = Math.min(1, (elapsed - revealDelay)/(revealSteps*rainSpeed));
    revealFace(p);
  }
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* rain update */
function rainFrame(){
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0,0,cv.width,cv.height);
  for(let c=0;c<cols;c++){
    const ch = glyphs[Math.random()*glyphs.length|0];
    const r  = drops[c];
    if(r<rows) buf[r][c]=ch;
    drops[c]=(r+1)%rows;
  }
}

/* portrait reveal */
function revealFace(progress){
  const h = faceArt.length, w = faceArt[0].length;
  const top  = Math.floor((rows-h)/2);
  const left = Math.floor((cols-w)/2);
  for(let y=0;y<h;y++){
    const row = faceArt[y];
    for(let x=0;x<w;x++){
      const ch = row[x];
      if(ch!== ' ' && Math.random()<progress){
        const ry = top+y, cx = left+x;
        if(ry>=0&&ry<rows&&cx>=0&&cx<cols) buf[ry][cx]=ch;
      }
    }
  }
}

/* draw buffer */
function draw(){
  ctx.font = "16px Hack,monospace";
  ctx.textBaseline = "top";
  ctx.fillStyle="#0f0";
  for(let r=0;r<rows;r++) ctx.fillText(buf[r].join(""),0,r*16);
}

/* resize canvas */
function resize(){
  cv.width  = innerWidth;
  cv.height = innerHeight;
}
})();
    document.getElementById('start-btn').addEventListener('click', () => {
        document.getElementById('intro').style.display = 'none';
        document.getElementById('map').style.display = 'block';
        document.getElementById('hud').style.display = 'block';
        const script = document.createElement('script');
        script.src = 'game.js';
        document.body.appendChild(script);
    });
    </script>
</body>
</html>
