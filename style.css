/* Reset and base styles for full-screen layout */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #000;
}
body {
  font-family: "Hack", monospace;
  color: #fff;
  overflow: hidden;
}

:root{
  --nav-h: 0px;
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
}

/* Intro screen overlay (covers the whole viewport) */
#intro {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: #000;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 3000;  /* render above game UI */
}

/* Game logo in intro (pixelated for retro effect) */
#logo {
  max-width: 80%;
  max-height: 60vh;
  image-rendering: pixelated;
}

/* Pulsing Start Game button (Phase 1) */
#start-btn {
  margin: 20px;
  padding: 12px 28px;
  font-size: 32px;
  font-family: "Hack", monospace;
  color: #fff;
  background: #ff0000;
  border: 2px solid #fff;
  text-transform: uppercase;
  cursor: pointer;
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.1); }
  100% { transform: scale(1); }
}

/* Story intro content (Phase 2) */
#intro-content {
  display: none;               /* shown after first click */
  flex-direction: row;
  align-items: flex-start;     /* top-align portrait and text */
  justify-content: center;
  padding: 20px;
  max-width: 90%;
  color: #fff;
  font-family: "Hack", monospace;
}
#boss-img {
  width: 200px;
  image-rendering: pixelated;
  margin-right: 20px;
}
#story-text {
  flex: 1;
  font-size: 18px;
  line-height: 1.4;
  border-left: 2px solid #fff;
  padding-left: 20px;
  min-height: 150px;  /* reserve space for text */
  /* Limit the story text height and enable scrolling so it doesn't fill the page */
  max-height: 35vh;
  overflow-y: auto;
}

/* Map container (hidden until game start) */
#map {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  display: none;
}

/* Heads-up display (HUD) for deliveries and timers */
#hud{
  position:absolute;
  top: calc(var(--safe-top) + var(--nav-h) + 10px);
  left: calc(var(--safe-left) + 10px);
  font-family:"Hack",monospace;
  font-size: clamp(14px, 3.2vw, 18px);
  line-height: 1.3;
  color:#fff;
  background: rgba(0,0,0,.85);
  padding:6px 10px;
  border:2px solid #fff;
  display:block;
  z-index:2100;
  box-shadow:0 2px 10px rgba(0,0,0,.5);
  max-width: min(46vw, 360px);
}

/* compass and directional arrows */
#compass{ position:absolute; bottom: calc(var(--safe-bottom) + 10px); left: calc(var(--safe-left) + 10px); z-index:2000; }
#pizza-compass{
  display:flex; align-items:center; gap:8px;
  background:rgba(0,0,0,.75); padding:6px 8px; border:1px solid rgba(255,255,255,.6);
  border-radius:6px; box-shadow:0 2px 8px rgba(0,0,0,.5);
}
#pizza-arrow{ width:34px; height:24px; transform-origin:50% 50%; filter:drop-shadow(0 0 4px rgba(0,0,0,.6)); }
#pizza-label{ color:#fff; font-family:"Hack",monospace; font-size:14px; }

/* hide old house triangle if still present */
#house-arrow{ display:none; }

/* Phone icon (rings with pulse animation) */
#phone-icon{ position:absolute; top: calc(var(--safe-top) + 10px); right: calc(var(--safe-right) + 10px); width:56px; display:none; z-index:2000; image-rendering:pixelated; cursor:pointer; }
#phone-icon.ringing {
  animation: phonePulse 1s infinite;
}
@keyframes phonePulse {
  0% { transform: scale(1); filter: drop-shadow(0 0 0 rgba(255,235,59,0)); }
  50% { transform: scale(1.1); filter: drop-shadow(0 0 12px rgba(255,235,59,.9)); }
  100% { transform: scale(1); filter: drop-shadow(0 0 0 rgba(255,235,59,0)); }
}

/* Phone message popup */
#phone-message{
  position:absolute;
  top: calc(var(--safe-top) + var(--nav-h) + 10px);
  right: calc(var(--safe-right) + 10px);
  font-family:"Hack",monospace;
  font-size: clamp(14px, 3.2vw, 18px);
  color:#fff;
  background: rgba(0,0,0,.9);
  padding:8px 10px;
  border:2px solid #ffeb3b;
  max-width: min(46vw, 360px);
  white-space: normal;
  overflow-wrap: break-word;
  display:none;
  z-index:2150;
  box-shadow:0 2px 12px rgba(0,0,0,.6);
}
#phone-message.slide-in {
  animation: slideIn .25s ease-out;
}
@keyframes slideIn {
  from { transform: translateY(-8px); opacity: 0; }
  to   { transform: translateY(0);    opacity: 1; }
}

/* navigation banner */
#nav-banner{
  position:absolute;
  top: calc(var(--safe-top) + 6px);
  left:50%;
  transform:translateX(-50%);
  display:none;
  align-items:center;
  gap:8px;
  font-family:"Hack",monospace;
  font-size: clamp(14px, 3.6vw, 20px);
  color:#111;
  background:#ffeb3b;
  border:2px solid #111;
  padding:6px 12px;
  border-radius:6px;
  z-index:2200;
  box-shadow:0 2px 10px rgba(0,0,0,.35);
  max-width: calc(100vw - 16px);
}
#nav-text{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: calc(100vw - 88px); /* keeps arrow visible */
}
#nav-arrow{ width:34px; height:24px; flex-shrink:0; transform-origin:50% 50%; }

/* Tutorial message overlay */
#tutorial-msg {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.85);
  color: #fff;
  font-family: "Hack", monospace;
  font-size: 18px;
  padding: 10px 14px;
  border: 2px solid #ffeb3b;
  text-align: center;
  max-width: 80%;
  z-index: 2500;
  display: none;
}

/* Message log for last three messages */
#msg-log{
  position:absolute;
  bottom: calc(var(--safe-bottom) + 10px);
  right: calc(var(--safe-right) + 10px);
  width: min(92vw, 390px);
  z-index:2050;
  pointer-events:none;
}
#msg-log .msg{
  background: rgba(0,0,0,.78);
  color:#fff;
  border:1px solid rgba(255,255,255,.6);
  padding:6px 8px;
  margin-top:8px;
  font-size:14px;
  box-shadow:0 2px 8px rgba(0,0,0,.5);
  border-radius:8px;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
  pointer-events:auto;
}

/* Pulsing target ring at active house */
.leaflet-marker-pane .target-pulse {
  width: 26px;
  height: 26px;
  border: 3px solid #ffeb3b;
  border-radius: 50%;
  box-sizing: border-box;
  pointer-events: none;
  animation: ring 1.2s ease-out infinite;
}
@keyframes ring {
  0%   { transform: scale(.6); opacity: .9; }
  80%  { transform: scale(2.2); opacity: 0; }
  100% { opacity: 0; }
}

/* Game Over overlay (full-screen, shown at end of game) */
#game-over {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  font-family: "Hack", monospace;
  font-size: 24px;
  text-align: center;
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 4000;  /* above all other elements */
}
#game-over-content {
  max-width: 80%;
}

/* Boss image and text layout for game over screen */
#game-over-inner {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: 20px;
}
#game-over-inner .boss-img {
  width: 200px;
  image-rendering: pixelated;
  margin-right: 20px;
}
#game-over-text {
  flex: 1;
  font-size: 18px;
  line-height: 1.4;
  border-left: 2px solid #fff;
  padding-left: 20px;
  max-height: 35vh;
  overflow-y: auto;
}

/* Play again button */
#play-again-btn {
  margin-top: 20px;
  padding: 12px 28px;
  font-size: 32px;
  font-family: "Hack", monospace;
  color: #fff;
  background: #ff0000;
  border: 2px solid #fff;
  cursor: pointer;
  animation: pulse 2s infinite;
}

/* sound toggle */
#sound-toggle{
  position:absolute;
  bottom: calc(var(--safe-bottom) + 10px);
  right: calc(var(--safe-right) + 10px);
  z-index:2300;
  font-size:16px;
  padding:6px 10px;
  border-radius:6px;
  border:1px solid #111;
  background:#ffeb3b;
  color:#111;
}

/* mobile specific tweaks */
@media (max-width: 640px){
  #hud{ max-width: 44vw; }
  #phone-message{ max-width: 44vw; }
  #msg-log{ width: min(86vw, 360px); }
}

/* Increase the size of map icons (pizza, house, battery, turtle, coin) */
.pizza-icon,
.house-icon,
.battery-icon,
.turtle-icon,
.coin-icon {
  /* Large font to fill the div container for the emoji icons */
  /* Slightly reduce font-size after enlarging icons (approx. 30% smaller) */
  font-size: 140px;
  line-height: 1;
}
